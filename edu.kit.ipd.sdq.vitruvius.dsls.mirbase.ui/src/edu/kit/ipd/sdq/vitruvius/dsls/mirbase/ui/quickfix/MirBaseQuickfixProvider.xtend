/*
 * generated by Xtext 2.10.0-SNAPSHOT
 */
package edu.kit.ipd.sdq.vitruvius.dsls.mirbase.ui.quickfix

import org.eclipse.xtext.xbase.ui.quickfix.XbaseQuickfixProvider
import org.eclipse.xtext.ui.editor.quickfix.Fix
import edu.kit.ipd.sdq.vitruvius.dsls.mirbase.validation.MirBaseValidator
import org.eclipse.xtext.validation.Issue
import org.eclipse.xtext.ui.editor.quickfix.IssueResolutionAcceptor
import edu.kit.ipd.sdq.vitruvius.framework.util.bridges.EclipseBridge
import edu.kit.ipd.sdq.vitruvius.dsls.mirbase.mirBase.MetamodelImport

import static edu.kit.ipd.sdq.vitruvius.dsls.mirbase.validation.EclipsePluginHelper.*

/**
 * Custom quickfixes.
 *
 * See https://www.eclipse.org/Xtext/documentation/304_ide_concepts.html#quick-fixes
 */
class MirBaseQuickfixProvider extends XbaseQuickfixProvider {
	@Fix(MirBaseValidator.METAMODEL_IMPORT_DEPENDENCY_MISSING)
	def addDependencyToManifest(Issue issue, IssueResolutionAcceptor acceptor) {
		acceptor.accept(issue, 'Add depdendency.', 'Add the dependency', null) [
			element, context |
			
			val metamodelImport = element as MetamodelImport
			
			val contributorName = EclipseBridge.getNameOfContributorOfExtension(
						"org.eclipse.emf.ecore.generated_package",
						"uri", metamodelImport.package.nsURI)
						
			val project = getProject(metamodelImport.eResource)
			if (!hasDependency(project, contributorName)) {
				addDependency(project, contributorName)
			}
		]		
	}
}
